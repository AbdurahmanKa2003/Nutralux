 <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="images/favicon-32x32.png" type="image/x-icon" />

    <!-- SEO Meta Tags -->
    <title>Nutralux ‚Äî Vitamins and Supplements Store | Buy Vitamin C, Magnesium, Zinc</title>
    <meta name="description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta name="keywords" content="Nutralux, vitamins, supplements, buy vitamins, vitamin C, magnesium, zinc, multivitamins, probiotics, health, supplement store, online vitamin store, immunity supplements, energy vitamins" />
    <meta name="author" content="Nutralux" />
    <link rel="canonical" href="https://yourwebsite.com/index.html" /> <!-- Replace with your actual website URL -->

    <!-- Open Graph Meta Tags (for social networks) -->
    <meta property="og:title" content="Nutralux ‚Äî Vitamins and Supplements Store" />
    <meta property="og:description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yourwebsite.com/index.html" /> <!-- Replace with your actual website URL -->
    <meta property="og:image" content="https://yourwebsite.com/images/avatar.png" /> <!-- Replace with URL of your main image or logo -->
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card Meta Tags (for Twitter) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Nutralux ‚Äî Vitamins and Supplements Store" />
    <meta name="twitter:description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta name="twitter:image" content="https://yourwebsite.com/images/avatar.png" /> <!-- Replace with URL of your main image or logo -->

    <!-- box icons -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" />

    <!-- lang icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.11.0/css/flag-icons.min.css" />

    <!-- css -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Schema.org JSON-LD Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Nutralux",
      "url": "https://yourwebsite.com/", <!-- Replace with your website root URL -->
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://yourwebsite.com/catalog.html?q={search_term_string}", <!-- Replace with your search URL if available -->
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Nutralux",
      "url": "https://yourwebsite.com/", <!-- Replace with your website root URL -->
      "logo": "https://yourwebsite.com/images/favicon-32x32.png", <!-- Replace with your logo URL -->
      "sameAs": [
        "https://wa.me/905332452900",
        "https://www.tiktok.com/@nutraluxlife?_t=ZS-8yvEDo3bZth&_r=1",
        "https://t.me/nutralux",
        "https://clck.ru/3NQNkm"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+905332452900",
        "contactType": "customer service",
        "areaServed": "US"
      }
    }
    </script>
   <style>
    #chat-widget {
  position: fixed;
  bottom: 90px;
  right: 20px;
  z-index: 9999;
  display: none;
  width: 350px;
  height: 450px;
  background: #fff;
  border: 1px solid #ccc;
  border-radius: 10px;
  box-shadow: 0 4px 15px rgba(0,0,0,0.15);
  display: flex;
  flex-direction: column;
}

#chat-fab {
  position: fixed;
  bottom: 20px;
  right: 90px;
  z-index: 10000;
  display: flex;
  width: 60px;
  height: 60px;
  background: #4CAF50;
  color: white;
  border-radius: 50%;
  justify-content: center;
  align-items: center;
  font-size: 28px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.footer-icon-top {
  position: fixed;
  bottom: 20px;
  right: 20px;
  z-index: 10001;
  background: #4CAF50;
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
}

.footer-icon-top a {
  display: flex;
  justify-content: center;
  align-items: center;
  color: white;
  font-size: 24px;
  line-height: 1;
}

.chat-messages {
  flex-grow: 1;
  padding: 10px 15px;
  overflow-y: auto;
  background-color: #f9f9f9;
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.chat-input-container {
  display: flex;
  padding: 10px 15px;
  border-top: 1px solid #eee;
  background-color: #fff;
  flex-shrink: 0;
}

.chat-input-container .chat-input {
  flex-grow: 1;
  padding: 8px;
  border: 1px solid #ccc;
  border-radius: 5px 0 0 5px;
  margin-right: -1px;
  font-size: 14px;
}

.chat-input-container .chat-send {
  background-color: #4CAF50;
  color: white;
  border: none;
  padding: 8px 12px;
  cursor: pointer;
  border-radius: 0 5px 5px 0;
  font-weight: bold;
  flex-shrink: 0;
}

.message {
  max-width: 80%;
  padding: 6px 10px;
  border-radius: 10px;
  word-wrap: break-word;
  font-size: 14px;
}

.bot-message {
  background-color: #e0f2f1;
  align-self: flex-start;
}

.user-message {
  background-color: #4CAF50;
  color: white;
  align-self: flex-end;
}
.chat-container {
    width: 100%;
    height: 100%; /* –ó–∞–Ω–∏–º–∞–µ—Ç –≤—Å—é –≤—ã—Å–æ—Ç—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ #chat-widget */
    display: flex;
    flex-direction: column; /* –≠–ª–µ–º–µ–Ω—Ç—ã (—à–∞–ø–∫–∞, —Å–æ–æ–±—â–µ–Ω–∏—è, –≤–≤–æ–¥) —Ä–∞—Å–ø–æ–ª–∞–≥–∞—é—Ç—Å—è –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ */
    overflow: hidden; /* –í–∞–∂–Ω–æ: –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –ø—Ä–æ–∫—Ä—É—Ç–∫—É –≤—Å–µ–≥–æ –≤–∏–¥–∂–µ—Ç–∞ */
}    

  </style>
  </head>

 <body>
    <header class="header">
        <a href="#home" class="logo">Nutralux</a>

        <i class="bx bx-menu" id="menu-icon"></i>

        <nav class="navbar">
            <a href="#about" class="active">About</a>
            <a href="#services" class="active">Services</a>
            <a href="catalog.html" class="active">Catalog</a>
            <a href="#contact" class="active">Contact</a>
            <a href="index-ru.html" class="active lang"><span class="fi fi-ru"></span></a>
        </nav>
    </header>

    <section class="home" id="home">
        <div class="home-content">
            <h1>Nutralux</h1>
            <h3>Store of <span class="multiple-text"></span></h3>
            <p>
                Vitamins and supplements for health: vitamin C, magnesium, zinc, multivitamins, probiotics and more. Quality
                formulations, clear dosage instructions, and personalized selection assistance.
            </p>
            <div class="social-media">
                <a href="https://wa.me/905332452900" target="_blank" aria-label="WhatsApp Nutralux"><i class="bx bxl-whatsapp"></i></a>
                <a href="https://www.tiktok.com/@nutraluxlife?_t=ZS-8yvEDo3bZth&_r=1" target="_blank" aria-label="TikTok Nutralux"><i class="bx bxl-tiktok"></i></a>
                <a href="https://t.me/nutralux" target="_blank" aria-label="Telegram Nutralux"><i class="bx bxl-telegram"></i></a>
                <a href="https://clck.ru/3NQNkm" target="_blank" aria-label="Instagram Nutralux"><i class="bx bxl-instagram"></i></a>
            </div>
            <a href="catalog.html" class="btn">Go to Catalog</a>
        </div>

        <div class="home-img">
            <img src="images/avatar.png" alt="Woman holding a bottle of Nutralux vitamins with green label" />
        </div>
    </section>

    <section class="about" id="about">
        <div class="about-img">
            <img src="images/about-image.png" alt="Collection of various Nutralux vitamin and supplement bottles on white background" />
        </div>

        <div class="about-content">
            <h2 class="heading">About <span>Nutralux Store</span></h2>
            <h3>Supplements and vitamins for daily support</h3>
            <p>
                We select proven supplements with clear compositions and dosages. We help choose complexes for your needs ‚Äî
                immunity, energy, sleep, skin beauty, and much more.
            </p>
            <p>Focus: vitamin C, magnesium, zinc, women's multivitamins, probiotics, and basic complexes.</p>
        </div>
    </section>

    <section class="services" id="services">
        <h2 class="heading">Our <span>Nutralux Services</span></h2>

        <div class="services-container">
            <div class="services-box">
                <i class="bx bx-support"></i>
                <h3>Vitamin Selection Consultation</h3>
                <ul>
                    <li>Help with choosing formulations and dosages</li>
                    <li>Basic intake recommendations</li>
                </ul>
            </div>

            <div class="services-box">
                <i class="bx bx-package"></i>
                <h3>Fast Worldwide Delivery</h3>
                <ul>
                    <li>Same-day order shipping</li>
                    <li>Order status tracking</li>
                </ul>
            </div>

            <div class="services-box">
                <i class="bx bx-check-shield"></i>
                <h3>Quality and Supplement Transparency</h3>
                <ul>
                    <li>Only verified suppliers</li>
                    <li>Clear labels and compositions</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="portfolio" id="portfolio">
        <h2 class="heading">Popular <span>Nutralux Products</span></h2>
    
        <div class="portfolio-container">
            <div class="portfolio-box">
                <div class="portfolio-img">
                    <img src="images/omega-3.jpg" alt="Nutralux Omega-3 1000 mg bottle" />
                </div>
                <div class="portfolio-content">
                    <h4>Omega-3 1000 mg</h4>
                    <p>Brain, heart, and vision support</p>
                    <a href="product.html?slug=omega-3-1000" class="btn">Learn More</a>
                </div>
            </div>
    
            <div class="portfolio-box">
                <div class="portfolio-img">
                    <img src="images/womens-multivitamin.jpg" alt="Nutralux Women's Multivitamin bottle" />
                </div>
                <div class="portfolio-content">
                    <h4>Women's Multivitamin</h4>
                    <p>Daily balance and support</p>
                    <a href="product.html?slug=womens-multivitamin" class="btn">Learn More</a>
                </div>
            </div>
        </div>
    
        <div style="text-align:center; margin-top: 1.5rem;">
            <a href="catalog.html" class="btn">View Full Catalog</a>
        </div>
    </section>
    <section class="faq" id="faq">
        <h2 class="heading">Frequently Asked <span>Questions about Nutralux</span></h2>
    
        <div class="faq-container">
            <div class="faq-item">
                <h3>How fast is delivery?</h3>
                <p>Delivery usually takes 1-2 business days. We ship orders on the same day they are placed.</p>
            </div>
    
            <div class="faq-item">
                <h3>Can children take your vitamins?</h3>
                <p>Yes, we have special complexes for children. Please check the "For Kids" section in our catalog.</p>
            </div>
    
            <div class="faq-item">
                <h3>Are there discounts for multiple items?</h3>
                <p>Yes, for orders of 3 or more items, we offer discounts and free shipping.</p>
            </div>
    
            <div class="faq-item">
                <h3>What payment methods are available?</h3>
                <p>We accept card payments, e-wallets, and cash on delivery.</p>
            </div>
        </div>
    </section>
    <footer class="footer">
        <div class="footer-text">
            <p>¬© 2025 Nutralux</p>
        </div>

        <div class="footer-icon-top">
            <a href="#home"><i class="bx bx-up-arrow-alt"></i></a>
        </div>
    </footer>

    <div id="chat-fab" style="display: flex;">
        <i class="bx bx-chat"></i>
    </div>

    <div id="chat-widget" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">–ß–∞—Ç-–±–æ—Ç Nutralux</div>
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    <strong>–ë–æ—Ç:</strong> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø —á–∞—Ç-–±–æ—Ç Nutralux. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chat-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <button class="chat-send" id="chat-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/scrollreveal"></script>

    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <script src="script.js"></script>
    <script>
        /* to prevent Typed.js from breaking on pages without .multiple-text */
        if (typeof Typed !== 'undefined' && document.querySelector('.multiple-text')) {
            new Typed('.multiple-text', {
                strings: ['vitamins and supplements', 'daily health'],
                typeSpeed: 100,
                backSpeed: 100,
                backDelay: 1000,
                loop: true
            });
        }
    </script>
<script>
/* === üí¨ ULTRA IMPROVED NUTRALUX CHATBOT SCRIPT === */

let lastLanguage = 'ru';

// --- DOM Elements ---
const chatWidget = document.getElementById('chat-widget');
const chatFab = document.getElementById('chat-fab');
const chatInput = document.getElementById('chat-input');
const chatSend = document.getElementById('chat-send');
const chatMessages = document.getElementById('chat-messages');

// --- Toggle Chat Visibility ---
function toggleChat() {
  if (!chatWidget || !chatFab) return console.error("Chat elements not found.");
  const isHidden = chatWidget.style.display === 'none' || chatWidget.style.display === '';
  chatWidget.style.display = isHidden ? 'flex' : 'none';
  chatFab.innerHTML = isHidden ? '<i class="bx bx-x"></i>' : '<i class="bx bx-chat"></i>';
  if (isHidden) setTimeout(() => chatInput.focus(), 200);
}

chatFab?.addEventListener('click', toggleChat);

// --- Load & Save Chat History ---
function saveChatHistory() {
  if (chatMessages) localStorage.setItem('nutraluxChatHistory', chatMessages.innerHTML);
}
function loadChatHistory() {
  const saved = localStorage.getItem('nutraluxChatHistory');
  if (saved) chatMessages.innerHTML = saved;
}
window.addEventListener('beforeunload', saveChatHistory);
document.addEventListener('DOMContentLoaded', loadChatHistory);

// --- Greeting ---
function showGreeting() {
  if (!localStorage.getItem('nutraluxGreeted')) {
    addMessage(lastLanguage === 'ru'
      ? "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üëã –Ø –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç Nutralux. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?"
      : "Hello! üëã I'm Nutralux consultant. How can I help?");
    localStorage.setItem('nutraluxGreeted', 'true');
  }
}
document.addEventListener('DOMContentLoaded', showGreeting);

// --- Language Toggle Button ---
const chatHeader = document.querySelector('.chat-header');
if (chatHeader) {
  const langBtn = document.createElement('button');
  langBtn.id = 'lang-toggle';
  langBtn.textContent = 'üá∑üá∫';
  langBtn.style.cssText = 'float:right;background:none;border:none;cursor:pointer;font-size:20px;';
  chatHeader.appendChild(langBtn);
  langBtn.addEventListener('click', () => {
    lastLanguage = lastLanguage === 'ru' ? 'en' : 'ru';
    langBtn.textContent = lastLanguage === 'ru' ? 'üá∑üá∫' : 'üá¨üáß';
    addMessage(lastLanguage === 'ru'
      ? "‚úÖ –Ø–∑—ã–∫ –ø–µ—Ä–µ–∫–ª—é—á—ë–Ω –Ω–∞ —Ä—É—Å—Å–∫–∏–π."
      : "‚úÖ Language switched to English.", 'bot');
  });
}

// --- Text Normalization ---
function normalizeText(text) {
  let normalized = text.toLowerCase().trim();
  const corrections = {
    '–∏–º—É–Ω': '–∏–º–º—É–Ω–∏—Ç–µ—Ç', '–∏–º–º—É–Ω': '–∏–º–º—É–Ω–∏—Ç–µ—Ç', 'immunity': '–∏–º–º—É–Ω–∏—Ç–µ—Ç',
    '—Å–æ–Ω': '—Å–æ–Ω', 'sleep': '—Å–æ–Ω',
    '—ç–Ω–µ—Ä–≥': '—ç–Ω–µ—Ä–≥–∏—è', 'energy': '—ç–Ω–µ—Ä–≥–∏—è',
    '–º–æ–∑–≥': '–º–æ–∑–≥', '–ø–∞–º—è—Ç': '–º–æ–∑–≥', 'brain': '–º–æ–∑–≥',
    '–∫–æ–∂–∞': '–∫–æ–∂–∞', '–≤–æ–ª–æ—Å': '–∫–æ–∂–∞', 'beauty': '–∫–æ–∂–∞',
    '–≤–µ—Å': '–≤–µ—Å', '–¥–∏–µ—Ç': '–≤–µ—Å', '–ø–æ—Ö—É–¥': '–≤–µ—Å', 'weight': '–≤–µ—Å',
    '—Å–µ—Ä–¥—Ü': '—Å–µ—Ä–¥—Ü–µ', '–¥–∞–≤–ª–µ–Ω': '—Å–µ—Ä–¥—Ü–µ', 'heart': '—Å–µ—Ä–¥—Ü–µ',
    '–∂–µ–ª—É–¥': '–∂–µ–ª—É–¥–æ–∫', '–ø–∏—â–µ–≤–∞—Ä': '–∂–µ–ª—É–¥–æ–∫', 'digest': '–∂–µ–ª—É–¥–æ–∫'
  };
  for (const wrong in corrections) {
    const regex = new RegExp(`${wrong}\\w*`, 'gi');
    normalized = normalized.replace(regex, corrections[wrong]);
  }
  return normalized;
}

// --- Language Detection ---
function detectLanguage(text) {
  const hasRu = /[–∞-—è—ë]/i.test(text);
  const hasEn = /[a-z]/i.test(text);
  if (hasRu && !hasEn) return 'ru';
  if (hasEn && !hasRu) return 'en';
  return lastLanguage;
}

// --- Product Data ---
const products = [
  {slug:"magnesium-b6", name:"–ú–∞–≥–Ω–∏–π B6", short:"–ù–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, —Å–æ–Ω, —É—Å–≤–æ–µ–Ω–∏–µ –º–∞–≥–Ω–∏—è"},
  {slug:"vitamin-d3-10000", name:"–í–∏—Ç–∞–º–∏–Ω D3 10 000 –ú–ï", short:"–ò–º–º—É–Ω–∏—Ç–µ—Ç, –∫–∞–ª—å—Ü–∏–µ–≤—ã–π –æ–±–º–µ–Ω, —Å–æ—Å—É–¥—ã"},
  {slug:"zinc-complex", name:"–¶–∏–Ω–∫ (–∫–æ–º–ø–ª–µ–∫—Å)", short:"–ò–º–º—É–Ω–∏—Ç–µ—Ç, –∫–æ–∂–∞, –æ–±–º–µ–Ω"},
  {slug:"omega-3-1000", name:"–û–º–µ–≥–∞-3 1000 –º–≥", short:"–ú–æ–∑–≥, —Å–µ—Ä–¥—Ü–µ, –∑—Ä–µ–Ω–∏–µ"},
  {slug:"b-complex", name:"–í–∏—Ç–∞–º–∏–Ω B-–∫–æ–º–ø–ª–µ–∫—Å", short:"–≠–Ω–µ—Ä–≥–∏—è, –Ω–µ—Ä–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫—Ä–æ–≤—å"},
  {slug:"collagen-30-sachets", name:"–ö–æ–ª–ª–∞–≥–µ–Ω ‚Äî 30 —Å–∞—à–µ", short:"–ö–æ–∂–∞, —Å—É—Å—Ç–∞–≤—ã, –≤–æ–ª–æ—Å—ã –∏ –Ω–æ–≥—Ç–∏"}
];

// --- AI Response (simplified safe version) ---
function getAIResponse(message) {
  const msg = normalizeText(message);
  const lang = detectLanguage(message);
  lastLanguage = lang;

  if (/(–ø—Ä–∏–≤–µ—Ç|hello|hi|hey)/.test(msg))
    return lang === 'ru'
      ? "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üëã –Ø AI-–∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç Nutralux. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å? –ù–∞–ø—Ä–∏–º–µ—Ä: '—á—Ç–æ –ø–æ—Å–æ–≤–µ—Ç—É–µ—à—å –¥–ª—è —Å–Ω–∞ –∏ –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞?'"
      : "Hello! üëã I'm Nutralux AI consultant. How can I help? Example: 'What should I take for energy and focus?'";

  const map = {
    '—Å–æ–Ω': ['magnesium-b6'],
    '–∏–º–º—É–Ω–∏—Ç–µ—Ç': ['vitamin-d3-10000','zinc-complex'],
    '—ç–Ω–µ—Ä–≥–∏—è': ['b-complex'],
    '–º–æ–∑–≥': ['omega-3-1000','b-complex'],
    '–∫–æ–∂–∞': ['collagen-30-sachets','zinc-complex']
  };
  const found = Object.keys(map).find(k => msg.includes(k));
  if (found) {
    let res = lang === 'ru'
      ? `‚ú® –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è **${found}**:\n\n`
      : `‚ú® Recommendations for **${found}**:\n\n`;
    map[found].forEach(slug => {
      const p = products.find(x => x.slug === slug);
      if (p) res += `‚Ä¢ <a href="product.html?slug=${p.slug}" target="_blank"><strong>${p.name}</strong></a> - ${p.short}\n`;
    });
    return res;
  }

  return lang === 'ru'
    ? "ü§î –£—Ç–æ—á–Ω–∏—Ç–µ –≤–∞—à –∑–∞–ø—Ä–æ—Å. –Ø –ø–æ–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –¥–æ–±–∞–≤–∫–∏ –¥–ª—è —Å–Ω–∞, —ç–Ω–µ—Ä–≥–∏–∏, –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞, –º–æ–∑–≥–∞ –∏–ª–∏ –∫—Ä–∞—Å–æ—Ç—ã."
    : "ü§î Please clarify your request. I can help with sleep, energy, immunity, brain or beauty supplements.";
}

// --- Add Message ---
function addMessage(text, type='bot') {
  const div = document.createElement('div');
  div.className = `message ${type}-message`;
  div.innerHTML = type === 'user'
    ? `<strong>${lastLanguage==='ru'?'–í—ã':'You'}:</strong> ${text}`
    : `<strong>${lastLanguage==='ru'?'–ë–æ—Ç':'Bot'}:</strong> ${text.replace(/\n/g,'<br>')}`;
  chatMessages.appendChild(div);
  chatMessages.scrollTo({top: chatMessages.scrollHeight, behavior:'smooth'});
}

// --- Safe wrapper ---
function safeGetAIResponse(msg){
  try { return getAIResponse(msg); }
  catch(e){ console.error(e); 
    return lastLanguage==='ru'
      ? "‚ö†Ô∏è –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑."
      : "‚ö†Ô∏è Error processing your message. Try again."; }
}

// --- Send Message ---
function sendMessage() {
  const text = chatInput.value.trim();
  if (!text) return;
  addMessage(text, 'user');
  chatInput.value = '';
  chatSend.disabled = true; chatInput.disabled = true;

  const typing = document.createElement('div');
  typing.id='typing-indicator';
  typing.className='message bot-message';
  typing.innerHTML = `<strong>${lastLanguage==='ru'?'–ë–æ—Ç':'Bot'}:</strong> <em>${lastLanguage==='ru'?'–Ω–∞–±–∏—Ä–∞–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ...':'typing...'}</em>`;
  chatMessages.appendChild(typing);
  chatMessages.scrollTo({top:chatMessages.scrollHeight,behavior:'smooth'});

  setTimeout(() => {
    typing.remove();
    const reply = safeGetAIResponse(text);
    addMessage(reply,'bot');
    chatSend.disabled = false; chatInput.disabled = false;
    chatInput.focus();
  }, 1200);
}

chatSend?.addEventListener('click', sendMessage);
chatInput?.addEventListener('keypress', e => { if (e.key === 'Enter') sendMessage(); });

// --- UX polish ---
chatInput?.addEventListener('focus',()=>chatInput.placeholder='');

/* === MOBILE STYLES === */
const style = document.createElement('style');
style.innerHTML = `
@media (max-width:600px){
  #chat-widget{width:90%;height:80%;bottom:80px;left:5%;right:5%;border-radius:15px;}
}
.chat-messages::-webkit-scrollbar{width:6px;}
.chat-messages::-webkit-scrollbar-thumb{background:#4CAF50;border-radius:3px;}
`;
document.head.appendChild(style);

</script>
