 <!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="shortcut icon" href="images/favicon-32x32.png" type="image/x-icon" />

    <!-- SEO Meta Tags -->
    <title>Nutralux ‚Äî Vitamins and Supplements Store | Buy Vitamin C, Magnesium, Zinc</title>
    <meta name="description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta name="keywords" content="Nutralux, vitamins, supplements, buy vitamins, vitamin C, magnesium, zinc, multivitamins, probiotics, health, supplement store, online vitamin store, immunity supplements, energy vitamins" />
    <meta name="author" content="Nutralux" />
    <link rel="canonical" href="https://yourwebsite.com/index.html" /> <!-- Replace with your actual website URL -->

    <!-- Open Graph Meta Tags (for social networks) -->
    <meta property="og:title" content="Nutralux ‚Äî Vitamins and Supplements Store" />
    <meta property="og:description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://yourwebsite.com/index.html" /> <!-- Replace with your actual website URL -->
    <meta property="og:image" content="https://yourwebsite.com/images/avatar.png" /> <!-- Replace with URL of your main image or logo -->
    <meta property="og:locale" content="en_US" />

    <!-- Twitter Card Meta Tags (for Twitter) -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Nutralux ‚Äî Vitamins and Supplements Store" />
    <meta name="twitter:description" content="Nutralux ‚Äî your reliable online store for vitamins and supplements. We offer quality products: vitamin C, magnesium, zinc, multivitamins, probiotics. Extensive catalog, detailed descriptions, fast delivery worldwide." />
    <meta name="twitter:image" content="https://yourwebsite.com/images/avatar.png" /> <!-- Replace with URL of your main image or logo -->

    <!-- box icons -->
    <link rel="stylesheet" href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" />

    <!-- lang icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lipis/flag-icons@6.11.0/css/flag-icons.min.css" />

    <!-- css -->
    <link rel="stylesheet" href="styles.css" />

    <!-- Schema.org JSON-LD Markup -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "WebSite",
      "name": "Nutralux",
      "url": "https://yourwebsite.com/", <!-- Replace with your website root URL -->
      "potentialAction": {
        "@type": "SearchAction",
        "target": "https://yourwebsite.com/catalog.html?q={search_term_string}", <!-- Replace with your search URL if available -->
        "query-input": "required name=search_term_string"
      }
    }
    </script>
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Nutralux",
      "url": "https://yourwebsite.com/", <!-- Replace with your website root URL -->
      "logo": "https://yourwebsite.com/images/favicon-32x32.png", <!-- Replace with your logo URL -->
      "sameAs": [
        "https://wa.me/905332452900",
        "https://www.tiktok.com/@nutraluxlife?_t=ZS-8yvEDo3bZth&_r=1",
        "https://t.me/nutralux",
        "https://clck.ru/3NQNkm"
      ],
      "contactPoint": {
        "@type": "ContactPoint",
        "telephone": "+905332452900",
        "contactType": "customer service",
        "areaServed": "US"
      }
    }
    </script>
  <style>
/* === NUTRALUX CHAT ‚Äî IMPROVED STYLE === */

:root {
  --nlx-green: #4caf50;
  --nlx-light: #f5f8f7;
  --nlx-border: #dcdcdc;
  --nlx-text: #222;
}

/* FAB (–ø–ª–∞–≤–∞—é—â–∞—è –∫–Ω–æ–ø–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —á–∞—Ç–∞) */
#chat-fab {
  position: fixed;
  bottom: 25px;
  right: 85px;
  z-index: 10000;
  width: 58px;
  height: 58px;
  background: var(--nlx-green);
  color: #fff;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 28px;
  cursor: pointer;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
  transition: all 0.2s ease;
}
#chat-fab:hover {
  transform: scale(1.08);
}

/* –ö–Ω–æ–ø–∫–∞ –≤–≤–µ—Ä—Ö */
.footer-icon-top {
  position: fixed;
  bottom: 25px;
  right: 20px;
  z-index: 10001;
  background: var(--nlx-green);
  width: 50px;
  height: 50px;
  border-radius: 50%;
  display: flex;
  justify-content: center;
  align-items: center;
  box-shadow: 0 6px 16px rgba(0,0,0,0.25);
}
.footer-icon-top a {
  color: #fff;
  font-size: 24px;
  line-height: 1;
}

/* –í–∏–¥–∂–µ—Ç —á–∞—Ç–∞ */
#chat-widget {
  position: fixed;
  bottom: 95px;
  right: 20px;
  width: 340px;
  height: 470px;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 10px 25px rgba(0,0,0,0.15);
  overflow: hidden;
  display: none;
  flex-direction: column;
  z-index: 9999;
  -webkit-transform: translateZ(0);
}
.chat-container {
  width: 100%;
  height: 100%;
  display: flex;
  flex-direction: column;
}

/* –®–∞–ø–∫–∞ */
.chat-header {
  background: var(--nlx-green);
  color: #fff;
  font-weight: 600;
  text-align: center;
  padding: 10px 12px;
  font-size: 15px;
}

/* –°–æ–æ–±—â–µ–Ω–∏—è */
.chat-messages {
  flex-grow: 1;
  padding: 12px 16px;
  background: var(--nlx-light);
  overflow-y: auto;
  display: flex;
  flex-direction: column;
  gap: 10px;
  -webkit-overflow-scrolling: touch;
}

.message {
  max-width: 80%;
  padding: 8px 12px;
  border-radius: 12px;
  font-size: 15px;
  line-height: 1.4;
  word-wrap: break-word;
}
.bot-message {
  background: #e9f7ef;
  color: var(--nlx-text);
  align-self: flex-start;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}
.user-message {
  background: var(--nlx-green);
  color: #fff;
  align-self: flex-end;
  box-shadow: 0 1px 3px rgba(0,0,0,0.05);
}

/* –í–≤–æ–¥ */
.chat-input-container {
  display: flex;
  align-items: center;
  padding: 10px;
  border-top: 1px solid var(--nlx-border);
  background: #fff;
  gap: 6px;
}
.chat-input {
  flex-grow: 1;
  padding: 9px 10px;
  border: 1px solid var(--nlx-border);
  border-radius: 8px;
  font-size: 15px;
  transition: border 0.2s;
}
.chat-input:focus {
  outline: none;
  border-color: var(--nlx-green);
}
.chat-send {
  background: var(--nlx-green);
  color: #fff;
  border: none;
  padding: 9px 14px;
  border-radius: 8px;
  font-weight: 600;
  cursor: pointer;
  transition: background 0.2s;
}
.chat-send:hover {
  background: #43a047;
}

/* Mobile fix */
input, textarea, select {
  font-size: 16px !important;
}
html, body {
  overscroll-behavior: none;
  height: 100%;
}

/* Responsive */
@media (max-width: 480px) {
  #chat-widget {
    width: 92%;
    height: 75%;
    right: 4%;
    bottom: 100px;
  }
  #chat-fab {
    right: 85px;
  }
}
@supports (-webkit-touch-callout: none) {
  #chat-widget {
    bottom: env(safe-area-inset-bottom, 100px);
  }
}
</style>
  </head>

 <body>
    <header class="header">
        <a href="#home" class="logo">Nutralux</a>

        <i class="bx bx-menu" id="menu-icon"></i>

        <nav class="navbar">
            <a href="#about" class="active">About</a>
            <a href="#services" class="active">Services</a>
            <a href="catalog.html" class="active">Catalog</a>
            <a href="#contact" class="active">Contact</a>
            <a href="index-ru.html" class="active lang"><span class="fi fi-ru"></span></a>
        </nav>
    </header>

    <section class="home" id="home">
        <div class="home-content">
            <h1>Nutralux</h1>
            <h3>Store of <span class="multiple-text"></span></h3>
            <p>
                Vitamins and supplements for health: vitamin C, magnesium, zinc, multivitamins, probiotics and more. Quality
                formulations, clear dosage instructions, and personalized selection assistance.
            </p>
            <div class="social-media">
                <a href="https://wa.me/905332452900" target="_blank" aria-label="WhatsApp Nutralux"><i class="bx bxl-whatsapp"></i></a>
                <a href="https://www.tiktok.com/@nutraluxlife?_t=ZS-8yvEDo3bZth&_r=1" target="_blank" aria-label="TikTok Nutralux"><i class="bx bxl-tiktok"></i></a>
                <a href="https://t.me/nutralux" target="_blank" aria-label="Telegram Nutralux"><i class="bx bxl-telegram"></i></a>
                <a href="https://clck.ru/3NQNkm" target="_blank" aria-label="Instagram Nutralux"><i class="bx bxl-instagram"></i></a>
            </div>
            <a href="catalog.html" class="btn">Go to Catalog</a>
        </div>

        <div class="home-img">
            <img src="images/avatar.png" alt="Woman holding a bottle of Nutralux vitamins with green label" />
        </div>
    </section>

    <section class="about" id="about">
        <div class="about-img">
            <img src="images/about-image.png" alt="Collection of various Nutralux vitamin and supplement bottles on white background" />
        </div>

        <div class="about-content">
            <h2 class="heading">About <span>Nutralux Store</span></h2>
            <h3>Supplements and vitamins for daily support</h3>
            <p>
                We select proven supplements with clear compositions and dosages. We help choose complexes for your needs ‚Äî
                immunity, energy, sleep, skin beauty, and much more.
            </p>
            <p>Focus: vitamin C, magnesium, zinc, women's multivitamins, probiotics, and basic complexes.</p>
        </div>
    </section>

    <section class="services" id="services">
        <h2 class="heading">Our <span>Nutralux Services</span></h2>

        <div class="services-container">
            <div class="services-box">
                <i class="bx bx-support"></i>
                <h3>Vitamin Selection Consultation</h3>
                <ul>
                    <li>Help with choosing formulations and dosages</li>
                    <li>Basic intake recommendations</li>
                </ul>
            </div>

            <div class="services-box">
                <i class="bx bx-package"></i>
                <h3>Fast Worldwide Delivery</h3>
                <ul>
                    <li>Same-day order shipping</li>
                    <li>Order status tracking</li>
                </ul>
            </div>

            <div class="services-box">
                <i class="bx bx-check-shield"></i>
                <h3>Quality and Supplement Transparency</h3>
                <ul>
                    <li>Only verified suppliers</li>
                    <li>Clear labels and compositions</li>
                </ul>
            </div>
        </div>
    </section>

    <section class="portfolio" id="portfolio">
        <h2 class="heading">Popular <span>Nutralux Products</span></h2>
    
        <div class="portfolio-container">
            <div class="portfolio-box">
                <div class="portfolio-img">
                    <img src="images/omega-3.jpg" alt="Nutralux Omega-3 1000 mg bottle" />
                </div>
                <div class="portfolio-content">
                    <h4>Omega-3 1000 mg</h4>
                    <p>Brain, heart, and vision support</p>
                    <a href="product.html?slug=omega-3-1000" class="btn">Learn More</a>
                </div>
            </div>
    
            <div class="portfolio-box">
                <div class="portfolio-img">
                    <img src="images/womens-multivitamin.jpg" alt="Nutralux Women's Multivitamin bottle" />
                </div>
                <div class="portfolio-content">
                    <h4>Women's Multivitamin</h4>
                    <p>Daily balance and support</p>
                    <a href="product.html?slug=womens-multivitamin" class="btn">Learn More</a>
                </div>
            </div>
        </div>
    
        <div style="text-align:center; margin-top: 1.5rem;">
            <a href="catalog.html" class="btn">View Full Catalog</a>
        </div>
    </section>
    <section class="faq" id="faq">
        <h2 class="heading">Frequently Asked <span>Questions about Nutralux</span></h2>
    
        <div class="faq-container">
            <div class="faq-item">
                <h3>How fast is delivery?</h3>
                <p>Delivery usually takes 1-2 business days. We ship orders on the same day they are placed.</p>
            </div>
    
            <div class="faq-item">
                <h3>Can children take your vitamins?</h3>
                <p>Yes, we have special complexes for children. Please check the "For Kids" section in our catalog.</p>
            </div>
    
            <div class="faq-item">
                <h3>Are there discounts for multiple items?</h3>
                <p>Yes, for orders of 3 or more items, we offer discounts and free shipping.</p>
            </div>
    
            <div class="faq-item">
                <h3>What payment methods are available?</h3>
                <p>We accept card payments, e-wallets, and cash on delivery.</p>
            </div>
        </div>
    </section>
    <footer class="footer">
        <div class="footer-text">
            <p>¬© 2025 Nutralux</p>
        </div>

        <div class="footer-icon-top">
            <a href="#home"><i class="bx bx-up-arrow-alt"></i></a>
        </div>
    </footer>

    <div id="chat-fab" style="display: flex;">
        <i class="bx bx-chat"></i>
    </div>

    <div id="chat-widget" style="display: none;">
        <div class="chat-container">
            <div class="chat-header">–ß–∞—Ç-–±–æ—Ç Nutralux</div>
            <div class="chat-messages" id="chat-messages">
                <div class="message bot-message">
                    <strong>–ë–æ—Ç:</strong> –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –Ø —á–∞—Ç-–±–æ—Ç Nutralux. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?
                </div>
            </div>
            <div class="chat-input-container">
                <input type="text" class="chat-input" id="chat-input" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ...">
                <button class="chat-send" id="chat-send">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
            </div>
        </div>
    </div>
    <script src="https://unpkg.com/scrollreveal"></script>

    <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.12"></script>

    <script src="script.js"></script>
    <script>
        /* to prevent Typed.js from breaking on pages without .multiple-text */
        if (typeof Typed !== 'undefined' && document.querySelector('.multiple-text')) {
            new Typed('.multiple-text', {
                strings: ['vitamins and supplements', 'daily health'],
                typeSpeed: 100,
                backSpeed: 100,
                backDelay: 1000,
                loop: true
            });
        }
         </script>
<script>
(function () {
  document.addEventListener('DOMContentLoaded', () => {
    const chatWidget = document.getElementById('chat-widget');
    const chatFab = document.getElementById('chat-fab');
    const chatInput = document.getElementById('chat-input');
    const chatSend = document.getElementById('chat-send');
    const chatMessages = document.getElementById('chat-messages');
    if (!chatWidget || !chatFab || !chatInput || !chatSend || !chatMessages) {
      console.error('[NutraluxChat] Missing elements.');
      return;
    }

    /* === Dynamic Style Injection (from improved UI version) === */
    const style = document.createElement('style');
    style.textContent = `
      #chat-widget { display:none; flex-direction:column; position:fixed; bottom:95px; right:20px; width:340px; height:470px; background:#fff; border-radius:14px; box-shadow:0 10px 25px rgba(0,0,0,0.15); overflow:hidden; z-index:9999; -webkit-transform:translateZ(0); }
      #chat-widget.is-open { display:flex; }
      #chat-fab { position:fixed; bottom:25px; right:85px; z-index:10000; width:58px; height:58px; background:#4caf50; color:#fff; border-radius:50%; display:flex; justify-content:center; align-items:center; font-size:28px; cursor:pointer; box-shadow:0 6px 16px rgba(0,0,0,0.25); transition:all 0.2s ease; }
      #chat-fab:hover { transform:scale(1.08); }
      .chat-header { background:#4caf50; color:#fff; font-weight:600; text-align:center; padding:10px 12px; font-size:15px; }
      .chat-messages { flex-grow:1; padding:12px 16px; background:#f5f8f7; overflow-y:auto; display:flex; flex-direction:column; gap:10px; -webkit-overflow-scrolling:touch; }
      .message { max-width:80%; padding:8px 12px; border-radius:12px; font-size:15px; line-height:1.4; word-wrap:break-word; box-shadow:0 1px 3px rgba(0,0,0,0.05); }
      .bot-message { background:#e9f7ef; color:#222; align-self:flex-start; }
      .user-message { background:#4caf50; color:#fff; align-self:flex-end; }
      .chat-input-container { display:flex; align-items:center; padding:10px; border-top:1px solid #dcdcdc; background:#fff; gap:6px; }
      .chat-input { flex-grow:1; padding:9px 10px; border:1px solid #dcdcdc; border-radius:8px; font-size:15px; transition:border 0.2s; }
      .chat-input:focus { outline:none; border-color:#4caf50; }
      .chat-send { background:#4caf50; color:#fff; border:none; padding:9px 14px; border-radius:8px; font-weight:600; cursor:pointer; transition:background 0.2s; }
      .chat-send:hover { background:#43a047; }
      input, textarea, select { font-size:16px !important; }
      html, body { overscroll-behavior:none; height:100%; }
      @media (max-width:480px){ #chat-widget { width:92%; height:75%; right:4%; bottom:100px; } #chat-fab { right:85px; } }
      @supports (-webkit-touch-callout:none){ #chat-widget { bottom:env(safe-area-inset-bottom,100px); } }
      .chat-messages::-webkit-scrollbar{width:6px;} .chat-messages::-webkit-scrollbar-thumb{background:#4caf50; border-radius:3px;}
    `;
    document.head.appendChild(style);

    /* === Logic === */
    let lastLanguage = 'ru';
    chatFab.addEventListener('click', () => {
      chatWidget.classList.toggle('is-open');
      const opened = chatWidget.classList.contains('is-open');
      chatFab.innerHTML = opened ? '<i class="bx bx-x"></i>' : '<i class="bx bx-chat"></i>';
      if (opened) setTimeout(() => chatInput.focus(), 150);
    });

    function addMessage(text, type = 'bot') {
      const div = document.createElement('div');
      div.className = `message ${type}-message`;
      div.innerHTML = type === 'user'
        ? `<strong>${lastLanguage === 'ru' ? '–í—ã' : 'You'}:</strong> ${text}`
        : `<strong>${lastLanguage === 'ru' ? '–ë–æ—Ç' : 'Bot'}:</strong> ${text.replace(/\n/g, '<br>')}`;
      chatMessages.appendChild(div);
      chatMessages.scrollTo({ top: chatMessages.scrollHeight, behavior: 'smooth' });
    }

    function detectLanguage(text) {
      const hasRu = /[–∞-—è—ë]/i.test(text);
      const hasEn = /[a-z]/i.test(text);
      if (hasRu && !hasEn) return 'ru';
      if (hasEn && !hasRu) return 'en';
      return lastLanguage;
    }

    function normalizeText(text) {
      return text.toLowerCase().replace(/[^\w–∞-—è—ë\s]/gi, ' ').replace(/\s+/g, ' ').trim();
    }

    const products = [
      {slug:"ginkgo-biloba-500",name:{ru:"–ì–∏–Ω–∫–≥–æ –ë–∏–ª–æ–±–∞ 500 –º–≥",en:"Ginkgo Biloba 500 mg"},short:{ru:"–ü–∞–º—è—Ç—å, –≤–Ω–∏–º–∞–Ω–∏–µ, –∫—Ä–æ–≤–æ–æ–±—Ä–∞—â–µ–Ω–∏–µ –º–æ–∑–≥–∞",en:"Memory, focus, brain circulation"}},
      {slug:"magnesium-b6",name:{ru:"–ú–∞–≥–Ω–∏–π B6",en:"Magnesium B6"},short:{ru:"–°–æ–Ω, –Ω–µ—Ä–≤—ã, —É—Å–≤–æ–µ–Ω–∏–µ –º–∞–≥–Ω–∏—è",en:"Sleep, nerves, magnesium absorption"}},
      {slug:"vitamin-d3-10000",name:{ru:"–í–∏—Ç–∞–º–∏–Ω D3 10 000 –ú–ï",en:"Vitamin D3 10,000 IU"},short:{ru:"–ò–º–º—É–Ω–∏—Ç–µ—Ç, –∫–æ—Å—Ç–∏, —Å–æ—Å—É–¥—ã",en:"Immunity, bones, vessels"}},
      {slug:"zinc-complex",name:{ru:"–¶–∏–Ω–∫ (–∫–æ–º–ø–ª–µ–∫—Å)",en:"Zinc Complex"},short:{ru:"–ò–º–º—É–Ω–∏—Ç–µ—Ç, –∫–æ–∂–∞, –æ–±–º–µ–Ω",en:"Immunity, skin, metabolism"}},
      {slug:"omega-3-1000",name:{ru:"–û–º–µ–≥–∞-3 1000 –º–≥",en:"Omega-3 1000 mg"},short:{ru:"–ú–æ–∑–≥, —Å–µ—Ä–¥—Ü–µ, –∑—Ä–µ–Ω–∏–µ",en:"Brain, heart, vision"}},
      {slug:"b-complex",name:{ru:"–í–∏—Ç–∞–º–∏–Ω B-–∫–æ–º–ø–ª–µ–∫—Å",en:"Vitamin B-Complex"},short:{ru:"–≠–Ω–µ—Ä–≥–∏—è, –∫—Ä–æ–≤—å, –Ω–µ—Ä–≤—ã",en:"Energy, blood, nerves"}},
      {slug:"collagen-30-sachets",name:{ru:"–ö–æ–ª–ª–∞–≥–µ–Ω ‚Äî 30 —Å–∞—à–µ",en:"Collagen ‚Äî 30 sachets"},short:{ru:"–ö–æ–∂–∞, —Å—É—Å—Ç–∞–≤—ã, –≤–æ–ª–æ—Å—ã",en:"Skin, joints, hair"}},
      {slug:"probiotic-30b",name:{ru:"–ü—Ä–æ–±–∏–æ—Ç–∏–∫",en:"Probiotic"},short:{ru:"–ñ–ö–¢, –∏–º–º—É–Ω–∏—Ç–µ—Ç",en:"Gut health, immunity"}}
    ];

    const patterns = {
      sleep: /(—Å–æ–Ω|—Å–ø–∞—Ç—å|—É—Å–Ω—É—Ç—å|sleep|insomnia|night|relax)/,
      energy: /(—ç–Ω–µ—Ä–≥|—É—Å—Ç–∞–ª|—Å–∏–ª|–≤—è–ª|energy|tired|fatigue|vitality)/,
      brain: /(–º–æ–∑–≥|–ø–∞–º—è—Ç|–≤–Ω–∏–º–∞–Ω|focus|brain|memory|concentr)/,
      immunity: /(–∏–º–º—É–Ω–∏—Ç|–±–æ–ª–µ–∑–Ω|–≤–∏—Ä—É—Å|–ø—Ä–æ—Å—Ç—É–¥|immun|cold|health)/,
      beauty: /(–∫–æ–∂|–≤–æ–ª–æ—Å|–Ω–æ–≥—Ç|beauty|skin|hair|nail|collagen)/,
      stomach: /(–∂–µ–ª—É–¥|–ø–∏—â–µ–≤–∞—Ä|–∫–∏—à–µ—á|stomach|digest|gut|probiotic)/,
      heart: /(—Å–µ—Ä–¥—Ü|–¥–∞–≤–ª–µ–Ω|–∫–∞—Ä–¥–∏–æ|heart|blood|vessel|cholesterol)/,
      weight: /(–≤–µ—Å|–ø–æ—Ö—É–¥|–¥–∏–µ—Ç|slim|weight|fat|metabol)/
    };

    function getAIResponse(message) {
      const lang = detectLanguage(message);
      lastLanguage = lang;
      const msg = normalizeText(message);

      if (/(–ø—Ä–∏–≤–µ—Ç|–∑–¥—Ä–∞–≤—Å—Ç–≤|hi|hello|hey|start|–Ω–∞—á–∞—Ç—å)/.test(msg))
        return lang === 'ru'
          ? "–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! üëã –Ø –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç Nutralux. –Ø –ø–æ–º–æ–≥—É –ø–æ–¥–æ–±—Ä–∞—Ç—å –≤–∏—Ç–∞–º–∏–Ω—ã –¥–ª—è —Å–Ω–∞, —ç–Ω–µ—Ä–≥–∏–∏, –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞, –∫–æ–∂–∏, —Å–µ—Ä–¥—Ü–∞ –∏ –ñ–ö–¢. –ù–∞–ø–∏—à–∏—Ç–µ —Ü–µ–ª—å –∏–ª–∏ —Å–∫–∞–∂–∏—Ç–µ ¬´–ø–æ–∫–∞–∂–∏ –∫–∞—Ç–∞–ª–æ–≥¬ª."
          : "Hello! üëã I'm Nutralux consultant. I can recommend supplements for sleep, energy, immunity, skin, heart and digestion. Tell me your goal or say 'show catalog'.";

      if (/(–≤–µ—Å—å –∫–∞—Ç–∞–ª–æ–≥|–≤—Å–µ —Ç–æ–≤–∞—Ä—ã|–ø–æ–∫–∞–∂–∏ –∫–∞—Ç–∞–ª–æ–≥|show all|all products|catalog)/.test(msg)) {
        let text = lang === 'ru' ? "üì¶ <b>–ö–∞—Ç–∞–ª–æ–≥ Nutralux:</b><br>" : "üì¶ <b>Nutralux Catalog:</b><br>";
        products.forEach(p => {
          text += `‚Ä¢ <a href="product.html?slug=${p.slug}" target="_blank">${p.name[lang]}</a> ‚Äî ${p.short[lang]}<br>`;
        });
        return text;
      }

      const found = Object.keys(patterns).filter(k => patterns[k].test(msg));

      if (found.length >= 2) {
        const has = k => found.includes(k);
        if (has('sleep') && has('immunity'))
          return lang === 'ru'
            ? "üí§üõ°Ô∏è –î–ª—è —Å–Ω–∞ –∏ –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞:<br>‚Ä¢ –ú–∞–≥–Ω–∏–π B6<br>‚Ä¢ –í–∏—Ç–∞–º–∏–Ω D3<br>‚Ä¢ –¶–∏–Ω–∫<br>üí° –í–µ—á–µ—Ä–æ–º ‚Äî –ú–∞–≥–Ω–∏–π; —É—Ç—Ä–æ–º ‚Äî D3 –∏ –¶–∏–Ω–∫."
            : "üí§üõ°Ô∏è For sleep & immunity:<br>‚Ä¢ Magnesium B6<br>‚Ä¢ Vitamin D3<br>‚Ä¢ Zinc<br>üí° Evening ‚Äî Magnesium; morning ‚Äî D3 & Zinc.";
        if (has('brain') && has('energy'))
          return lang === 'ru'
            ? "üß†‚ö° –î–ª—è —Ñ–æ–∫—É—Å–∞ –∏ —ç–Ω–µ—Ä–≥–∏–∏:<br>‚Ä¢ –ì–∏–Ω–∫–≥–æ –ë–∏–ª–æ–±–∞<br>‚Ä¢ –û–º–µ–≥–∞-3<br>‚Ä¢ B-–∫–æ–º–ø–ª–µ–∫—Å"
            : "üß†‚ö° For focus & energy:<br>‚Ä¢ Ginkgo Biloba<br>‚Ä¢ Omega-3<br>‚Ä¢ B-Complex";
      }

      if (found.length === 1) {
        const key = found[0];
        const header = {
          sleep:{ru:"üò¥ <b>–î–ª—è —Å–Ω–∞ –∏ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏—è:</b><br>",en:"üò¥ <b>For sleep & calm:</b><br>"},
          energy:{ru:"‚ö° <b>–î–ª—è —ç–Ω–µ—Ä–≥–∏–∏ –∏ –±–æ–¥—Ä–æ—Å—Ç–∏:</b><br>",en:"‚ö° <b>For energy & vitality:</b><br>"},
          immunity:{ru:"üõ°Ô∏è <b>–î–ª—è –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞:</b><br>",en:"üõ°Ô∏è <b>For immunity:</b><br>"},
          beauty:{ru:"üíÖ <b>–î–ª—è –∫–æ–∂–∏ –∏ –≤–æ–ª–æ—Å:</b><br>",en:"üíÖ <b>For skin & hair:</b><br>"},
          brain:{ru:"üß† <b>–î–ª—è –ø–∞–º—è—Ç–∏ –∏ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏:</b><br>",en:"üß† <b>For memory & focus:</b><br>"},
          stomach:{ru:"üçÄ <b>–î–ª—è –ñ–ö–¢ –∏ –º–∏–∫—Ä–æ—Ñ–ª–æ—Ä—ã:</b><br>",en:"üçÄ <b>For gut & microbiome:</b><br>"},
          heart:{ru:"‚ù§Ô∏è <b>–î–ª—è —Å–µ—Ä–¥—Ü–∞ –∏ —Å–æ—Å—É–¥–æ–≤:</b><br>",en:"‚ù§Ô∏è <b>For heart & vessels:</b><br>"},
          weight:{ru:"üèÉ <b>–î–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –≤–µ—Å–∞:</b><br>",en:"üèÉ <b>For weight control:</b><br>"}
        }[key];
        const pick = arr => arr.map(s => products.find(p => p.slug === s)).filter(Boolean);
        let list = [];
        if (key==='sleep') list = pick(['magnesium-b6']);
        if (key==='immunity') list = pick(['vitamin-d3-10000','zinc-complex']);
        if (key==='energy') list = pick(['b-complex']);
        if (key==='brain') list = pick(['ginkgo-biloba-500','omega-3-1000']);
        if (key==='beauty') list = pick(['collagen-30-sachets','zinc-complex']);
        if (key==='stomach') list = pick(['probiotic-30b']);
        if (key==='heart') list = pick(['omega-3-1000']);
        if (key==='weight') list = pick(['b-complex']);
        let out = header[lang];
        list.forEach(p => out += `‚Ä¢ <a href="product.html?slug=${p.slug}" target="_blank">${p.name[lang]}</a> ‚Äî ${p.short[lang]}<br>`);
        out += lang==='ru' ? "<br>üí° –ö—É—Ä—Å 1‚Äì2 –º–µ—Å—è—Ü–∞." : "<br>üí° 1‚Äì2 month course recommended.";
        return out;
      }

      const partial = products.filter(p =>
        p.name.ru.toLowerCase().includes(msg) || p.name.en.toLowerCase().includes(msg) ||
        p.short.ru.toLowerCase().includes(msg) || p.short.en.toLowerCase().includes(msg)
      );
      if (partial.length) {
        let res = lang==='ru' ? "üîç –ù–∞–π–¥–µ–Ω–æ:<br>" : "üîç Found:<br>";
        partial.forEach(p => res += `‚Ä¢ <a href="product.html?slug=${p.slug}" target="_blank">${p.name[lang]}</a> ‚Äî ${p.short[lang]}<br>`);
        return res;
      }

      if (/(help|–ø–æ–º–æ—â|—á—Ç–æ –º–æ–∂–µ—à—å|options|–≤–∞—Ä–∏–∞–Ω—Ç—ã|recommend|–ø–æ–¥—Å–∫–∞–∂–∏)/.test(msg))
        return lang==='ru'
          ? "–Ø –º–æ–≥—É –ø—Ä–µ–¥–ª–æ–∂–∏—Ç—å –¥–æ–±–∞–≤–∫–∏ –¥–ª—è üí§ —Å–Ω–∞, ‚ö° —ç–Ω–µ—Ä–≥–∏–∏, üõ°Ô∏è –∏–º–º—É–Ω–∏—Ç–µ—Ç–∞, üíÖ –∫—Ä–∞—Å–æ—Ç—ã, üß† –ø–∞–º—è—Ç–∏, ‚ù§Ô∏è —Å–µ—Ä–¥—Ü–∞ –∏ üçÄ –ñ–ö–¢.\n–ù–∞–ø–∏—à–∏—Ç–µ: ¬´—á—Ç–æ –¥–ª—è —Å–Ω–∞?¬ª –∏–ª–∏ ¬´–ø–æ–∫–∞–∂–∏ –∫–∞—Ç–∞–ª–æ–≥¬ª."
          : "I can help with üí§ sleep, ‚ö° energy, üõ°Ô∏è immunity, üíÖ beauty, üß† focus, ‚ù§Ô∏è heart and üçÄ gut.\nType: 'for sleep?' or 'show catalog'.";

      return lang==='ru'
        ? "ü§î –ù–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª. –ù–∞–ø–∏—à–∏—Ç–µ —Ü–µ–ª—å (—Å–æ–Ω, —ç–Ω–µ—Ä–≥–∏—è, –∏–º–º—É–Ω–∏—Ç–µ—Ç, –∫–æ–∂–∞) –∏–ª–∏ —Å–∫–∞–∂–∏—Ç–µ ¬´–∫–∞—Ç–∞–ª–æ–≥¬ª."
        : "ü§î I didn‚Äôt catch that. Say your goal (sleep, energy, immunity, skin) or 'catalog'.";
    }

    function safeAIResponse(msg) {
      try { return getAIResponse(msg); }
      catch(e){ console.error('[NutraluxChat] AI error', e); return lastLanguage==='ru'?"‚ö†Ô∏è –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏.":"‚ö†Ô∏è Processing error."; }
    }

    function sendMessage() {
      const text = chatInput.value.trim();
      if (!text) return;
      addMessage(text, 'user');
      chatInput.value = '';
      chatSend.disabled = true; chatInput.disabled = true;

      const typing = document.createElement('div');
      typing.className = 'message bot-message';
      typing.innerHTML = `<strong>${lastLanguage==='ru'?'–ë–æ—Ç':'Bot'}:</strong> <em>${lastLanguage==='ru'?'–ø–µ—á–∞—Ç–∞–µ—Ç...':'typing...'}</em>`;
      chatMessages.appendChild(typing);
      chatMessages.scrollTo({ top: chatMessages.scrollHeight, behavior: 'smooth' });

      setTimeout(() => {
        typing.remove();
        const reply = safeAIResponse(text);
        addMessage(reply, 'bot');
        chatSend.disabled = false; chatInput.disabled = false;
        chatInput.focus();
      }, 900);
    }

    chatSend.addEventListener('click', sendMessage);
    chatInput.addEventListener('keypress', e => { if (e.key === 'Enter') sendMessage(); });

    chatInput.addEventListener('focus', () => {
      chatInput.style.fontSize = '16px';
      document.body.style.height = '100vh';
      setTimeout(() => window.scrollTo(0, document.body.scrollHeight), 50);
    });
    chatInput.addEventListener('blur', () => { document.body.style.height = ''; });

    function saveHistory() { localStorage.setItem('nutraluxChatHistory', chatMessages.innerHTML); }
    function loadHistory() { const s = localStorage.getItem('nutraluxChatHistory'); if (s) chatMessages.innerHTML = s; }
    function greetUser() {
      if (!localStorage.getItem('nutraluxGreeted')) {
        addMessage("üëã Hello! / –ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! I'm Nutralux AI assistant. Ask me about vitamins or say 'catalog'.");
        localStorage.setItem('nutraluxGreeted','true');
      }
    }
    try { loadHistory(); } catch {}
    greetUser();
    window.addEventListener('beforeunload', saveHistory);
  });
})();
</script>
